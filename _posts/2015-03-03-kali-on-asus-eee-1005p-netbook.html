---
layout: post
title: Repairing the Asus EEE 1005p Netbook
date: '2015-03-03T17:24:00.000-08:00'
author: Steven Lavoie
tags:
- repair
- hardware
modified_time: '2015-05-30T20:53:53.120-07:00'
thumbnail: http://1.bp.blogspot.com/-y2xXdiHUmOU/VPzEkGA-N3I/AAAAAAAAJww/640ma922at4/s72-c/20150303_101855.jpg
blogger_id: tag:blogger.com,1999:blog-1636451537745562628.post-79358053648107280
blogger_orig_url: http://imtryingtoscience.blogspot.com/2015/03/kali-on-asus-eee-1005p-netbook.html
---

<div class="tr_bq"><a href="http://1.bp.blogspot.com/-y2xXdiHUmOU/VPzEkGA-N3I/AAAAAAAAJww/640ma922at4/s1600/20150303_101855.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="http://1.bp.blogspot.com/-y2xXdiHUmOU/VPzEkGA-N3I/AAAAAAAAJww/640ma922at4/s1600/20150303_101855.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="225" src="http://1.bp.blogspot.com/-y2xXdiHUmOU/VPzEkGA-N3I/AAAAAAAAJww/640ma922at4/s1600/20150303_101855.jpg" width="400" /></a></div><div style="text-align: center;"><span style="font-family: inherit; font-size: x-small;"><i>This post was updated. See the original further down.</i></span></div><br /><span style="font-family: inherit;">I got this little gem from a friend. It sat under her couch for quite a while after "it broke". She asked if I could pull all her music and photos off it. She's not a techie by any means so she wouldn't get rid of it until someone saved the baby pictures of her son. That was the easy part; I just plugged the drive into your standard SATA-USB connector. I offered to fix it but she had long since moved on so I gave her $50.</span><br /><br /><span style="font-family: inherit;">I could tell the LCD was bad, as was the keyboard, both probably related to the stick substance I could only presume was Coke syrup. She'd also said "the internet wasn't working" well either so something must have been wrong with the wifi.&nbsp;</span><br /><span style="font-family: inherit;"><br /></span>The LCD took a little while to hunt down but I went with <a href="http://www.amazon.com/gp/product/B003TP6D9A" target="_blank">this one</a>&nbsp;for $50 and it works great.&nbsp;<span style="font-family: inherit;">Turns out the wifi antenna was severed but the card was still good and&nbsp;</span>I replaced the keyboard with&nbsp;<a href="http://www.ebay.com/itm/ASUS-MP-09A33US-5283-04GOA191KUS10-2-US-Keyboard-white-new-/110796731509" target="_blank">this thing from eBay</a>&nbsp;for $16. (If you need to replace either of these components for your eee PC, take note of the model numbers on each item. There were multiple versions of each model with slightly different hardware, just nothing really visible to the end user.)<br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">I didn't buy/build a new wifi antenna since I put the whole thing back together before I remembered. I'd have to buy a new one of those tiny </span><a href="http://en.wikipedia.org/wiki/Hirose_U.FL" style="font-family: inherit;" target="_blank">Hirose U.FL connectors</a><span style="font-family: inherit;">&nbsp;to fashion a new antenna, which isn't the biggest PITA. The main problem with replacing it, if I ever do, is that the antenna needs to be soldered to a metallic sheet that's glued inside the cover </span><i style="font-family: inherit;">behind the LCD I just wrestled back into the case</i><span style="font-family: inherit;">. Not to mention, I tore up that sheet (of whatever substance) in the process of fixing this thing.&nbsp;</span>I just use a USB adapter but you can see the antenna hanging out of the right speaker opening (never put those back in either) and it works well enough for home use.<br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">The new keyboard doesn't always work but I think that's because I haven't totally put everything back together; the top of case is slightly bowed so it's mostly one line of keys in the center that aren't responsive. It had worked once or twice when everything was back together like normal.</span><br /><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Why is not back together like normal, you ask? The hard drive was bad too. I didn't notice any issues when pulling her photos off it but Windows wouldn't boot. So then I tried Kali. Below is my Log of Failure (and this original blog post before the above edits were added). Once I swapped the drive, everything was fine, but I lost interest in putting the case back together nicely.</span><br /><span style="font-family: inherit;"><br /></span>I've got a small pile of screws left over, which is really just par for the course when I'm repairing laptops.<br /><blockquote><i>Here's the original post:</i>&nbsp;</blockquote><blockquote>I've had a lot of weird issues with my netbook and Kali 1.1.0 (32-bit). First, I can boot via Live USB just fine. I can install just fine. Everything runs fine (other than some quirky issues with wifi that I didn't bother with much).</blockquote><blockquote><span style="font-family: inherit;">The install goes through just fine but after reboot, I get a "Gave up waiting for root device" error before getting dropped to initramfs and ash. Rebooting to Live USB is then inconsistent... sometimes it'll load just fine and sometimes I have to boot to the failsafe mode. Something else that's inconsistent, or maybe me going crazy, is that the brightness on the (recently replaced) LCD seems to drop randomly. I just noticed it this time while booting to failsafe on Live USB again.</span>&nbsp;</blockquote><blockquote><span style="font-family: inherit;">The SATA options in the BIOS make little difference:</span></blockquote><blockquote><span style="font-family: inherit;">1. Ehanced works whether in IDE or AHCI. By "works" I mean I get the same errors.</span><span style="font-family: inherit;">2. Compatible is just like Enhanced.</span><span style="font-family: inherit;">3. Disabled actually causes the Live USB to be booted by default. It is a SATA drive so I guess that makes sense.</span></blockquote><blockquote><span style="font-family: inherit;">Using a normal USB keyboard works fine since the BIOS supports. Using a wireless Logitech mouse/keyboard combo (K400r) also works... until I get to initramfs. Doing the install via the Logitech keyboard seems to have dropped the USB support from initramfs as even going back to the normal USB keyboard -- and after a reboot -- it doesn't work.</span></blockquote><blockquote><span style="font-family: inherit;">Anyway, I tried to rebuild initramfs but it failed and left me with a totally broken system. Rather than try to wrestle with this, I figured I'd go for round 3 of a Live USB install but set up the network beforehand via a handy ethernet cable and let the install run updates. This worked like a charm... until I tried to boot. Back to square one.&nbsp;</span><span style="font-family: inherit;">This time, I booted to Live USB again and chroot'd to the HDD install:</span></blockquote><blockquote><span style="font-family: inherit;">1. To make sure I didn't screw it up, I followed <a href="http://superuser.com/questions/111152/whats-the-proper-way-to-prepare-chroot-to-recover-a-broken-linux-installation" target="_blank">some instructions</a>. I specified ext4 since that's what Kali set up by default though fdisk -l just lists <a href="http://www.win.tue.nl/~aeb/partitions/partition_types-1.html" target="_blank">ID 83</a>.</span><span style="font-family: inherit;">2. I also added my swap (before chroot):&nbsp;swapon /dev/sda5.</span><span style="font-family: inherit;">3. I copied over my resolv.conf, just in case: <span style="font-size: 13.6960000991821px; line-height: 17.8048000335693px;">cp -L /etc/resolv.conf /mnt/etc/resolv.conf.</span>4. I updated my /etc/initramfs-tools/modules:</span><span style="font-family: inherit;">&nbsp; &nbsp; - Added the following modules for <a href="https://wiki.debian.org/Keyboard#How_to_enable_USB_keyboard_in_initramfs" target="_blank">USB keyboard support</a>: usbcore, uhci_hcd, ehci_hcd, usbhid</span><span style="font-family: inherit;">&nbsp; &nbsp; - Even though MODULES=most was set, I changed it to =list so I could try to add modules piecemeal and see what fixes things.</span><span style="font-family: inherit;">&nbsp; &nbsp; - I added ahci and libahci, in case that's the issue with the boot not finding my root partition.</span>5. Then, update-initramfs -u.<br />6. FAIL!&nbsp;</blockquote><blockquote>After a few seconds of 'thinking', I got two different I/O errors for scsi_mod.ko, one each for "reading" and "failed to extend," the latter pointing to the /var/tmp folder. That was followed by a "Bus error". Then a "could not read: Input/output error" for /usr/sbin/iucode_tool: /lib/firmware/intel-ucode/06-0f-0b.&nbsp;</blockquote><blockquote>Separately, I noticed I was getting this error on booting today, before the failure to mount my root partition. I wasn't getting it yesterday though, or at least hadn't noticed it. What's changed since yesterday and today? I cleared the BIOS by removing the CMOS battery and let them go to defaults (before the aforementioned SATA configuration changes). I also chose not to disable the onboard Wifi (Mini-PCI Express module). I'd disabled it previously because the antenna is broken so I just didn't want to deal with it. I'd also plugged the speakers back in. At this point, the only thing different from the factory default is the new LCD and the fact that the mic/webcam isn't plugged in, but it wasn't yesterday either.&nbsp;</blockquote><blockquote>Following that last error was a read error for /sbin/lvm and another "failed to extend" for the same. Then there was an assertion failure from depmod in libkmod-elf.c:207: elf_get_mem for "offset &lt; efl-&gt;size".&nbsp;</blockquote><blockquote>Hrmf. What to do? Is the HDD bad? Quite possibly. I'm too lazy to umount and run fsck right now though so let's try something else.&nbsp;</blockquote><blockquote>Changed MODULES=most back to list. Same crap... except two Bus errors this time and more I/O errors for other modules before it aborts. Ruh roh, maybe the HDD is bad.<br />dmesg shows a ton of ata1.00 errors, including READ FPDMA QUEUED <a href="https://bugs.launchpad.net/ubuntu/+source/linux/+bug/550559" target="_blank">which has previously been an issue</a> for some Linux users. Perhaps I'll go change the BIOS SATA settings: Ehanced IDE. Reboot to the recovery mode makes no change. Back to Live USB's failsafe. Interestingly, it didn't mount my local filesystem this time. Oh well, chroot'd again.&nbsp;</blockquote><blockquote>Let's look into that goofy microcode error from earlier. Kernel config has nothing special I noticed. Rna apt-get intel-microcode... it's already installed. Let's try <a href="http://ubuntuforums.org/archive/index.php/t-1040648.html" target="_blank">something</a>:<br />echo 1 &gt; /sys/devices/system/cpu/microcode/reload<br />dmesg<br />Relevant line: platform microcode: firmware: direct-loading firmware intel-ucode/06/1c/0a&nbsp;</blockquote><blockquote>That's a different version from the error earlier:&nbsp;/lib/firmware/intel-ucode/06-0f-0b. Let's try&nbsp;update-initramfs -uv.&nbsp;</blockquote><blockquote>A few errors throughout but "Calling hook dmsetup" had the same assertion failure as before. It then said "Aborted" then "Bus error" and then said it was building the new initramfs anyway.&nbsp;</blockquote><blockquote>I called "file" on the new initrd image and got a bus error again. Let me look at dmesg again:<br />microcode: CPU0 sig=0x106ca, pf=0x4, revision=0x107<br />microcode: Microcode Update Driver: v2.00 &lt;tigran@aivazian.fsnet.co.uk&gt;, Peter Oruba&nbsp;</blockquote><blockquote>Checked out an old <a href="https://lists.debian.org/debian-user/2013/07/msg00380.html" target="_blank">mailing list post</a>... nothing good. Tried: iucode_tool -s 0x000106ca -l /lib/firmware/intel-ucode/ and got the same IO error as above, referring to 06-0f-0b. That file exists in the directory...&nbsp;</blockquote><blockquote>Let me just steal the initrd.img from the live USB and see what happens. Stopped at Grub and just booted from the command line:<br />linux (hd0,msdos1)/boot/vmlinuz root=/dev/sda1<br />initrd (hd0,msdos1)/initrd.img<br />boot&nbsp;</blockquote><blockquote>Weird that it's msdos1 today. Yesterday it was just '1'. Boot worked just fine except I got the Black Screen of Death like the non-failsafe mode on the Live USB.&nbsp;</blockquote><blockquote>I'll have to dig into the module differences between the two and see what's going on... another time. Gah.</blockquote>