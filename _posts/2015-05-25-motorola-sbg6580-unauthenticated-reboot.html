---
layout: post
title: Motorola SBG6580 Unauthenticated Reboot
date: '2015-05-25T12:41:00.003-07:00'
author: Steven Lavoie
tags:
- pentesting
- tutorial
modified_time: '2015-05-30T20:55:49.553-07:00'
thumbnail: http://3.bp.blogspot.com/-dygC_vkvljs/VWpsODMnoEI/AAAAAAAAUwY/XVb0-PYlCrQ/s72-c/20150530_155732.jpg
blogger_id: tag:blogger.com,1999:blog-1636451537745562628.post-3620987625409830883
blogger_orig_url: http://imtryingtoscience.blogspot.com/2015/05/motorola-sbg6580-unauthenticated-reboot.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-dygC_vkvljs/VWpsODMnoEI/AAAAAAAAUwY/XVb0-PYlCrQ/s1600/20150530_155732.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-dygC_vkvljs/VWpsODMnoEI/AAAAAAAAUwY/XVb0-PYlCrQ/s320/20150530_155732.jpg" width="128" /></a></div><i>Disclaimer: This is my personal equipment, not rented or leased from my ISP. Don't screw with equipment you don't own. Do anything here at your own risk. This is for my personal education. That said, it did not appear to damage my router in any way; I just lost service while the gateway rebooted.</i><br /><br /><br />So, I was playing around with Burpsuite a bit to see if I could screw with my modem/router gateway thing to bypass the credentials. No dice there.<br /><br />Nonetheless, I did find that I could reboot the router without being logged in.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Here's a step-by-step:<br /><ol><li>Enter your browser's network settings and turn on the proxy. Use 127.0.0.1:8080. Ensure you don't have any options/checkboxes set for bypassing the proxy for localhost (set by default in Iceweasel 31.7 on Kali).</li><li>Launch Burpsuite. Go to the Proxy tab and the Internet sub-tab. Ensure you see "Intercept is On". Then go to the Options sub-tab and ensure the "Running" checkbox is set for 127.0.0.1.</li><li>Go to your browser and enter the SBG6580's IP address. By default, it's 192.168.0.1.</li></ol>Now, every single GET and POST request to/from your system will be intercepted by Burpsuite. You view them by going to the Proxy tab and Intercept sub-tab. You can manually edit the request or leave it as is and click "Forward".<br /><br />Optionally, you can right-click in the textbox and choose "Send to Intruder" if you want to try dictionary attacks on the credentials (Google <i>burpsuite cluster bomb</i>).<br /><br />To reboot the modem, just copy/paste the following text in place of whatever request you've intercepted.<br /><pre style="background: #000000; color: #d1d1d1;"><html><body style="background: #000000; color: #d1d1d1;"><pre><br />POST /goform/RgConfiguration HTTP/<span style="color: #00a800;">1.1</span><br />Host: <span style="color: #00a800;">10.0.0.1</span><br />User-Agent: Mozilla/<span style="color: #00a800;">5.0</span> (X11; Linux x86_64; rv:<span style="color: #00a800;">31.0</span>) Gecko/<span style="color: #00a800;">20100101</span> Firefox/<span style="color: #00a800;">31.0</span> Iceweasel/<span style="color: #00a800;">31.7.0</span> <br />Accept: text/html,application/xhtml+xml,application/xml;q=<span style="color: #00a800;">0.9</span>,*/*;q=<span style="color: #00a800;">0.8</span> <br />Accept-Language: en-US,en;q=<span style="color: #00a800;">0.5</span> <br />Accept-Encoding: gzip, deflate <br />Referer: http://<span style="color: #00a800;">10.0.0.1</span>/RgConfiguration<span style="color: #00a800;">.</span>asp <br />Connection: keep-alive <br />Content-Type: application/x-www-form-urlencoded <br />Content-Length: <span style="color: #00a800;">18</span> <br /><br />SaveChanges=Reboot<br /></pre></body></html></pre><br />To get this, I logged in normally (just forwarded those requests normally) and went to the Configuration page. I clicked "Reboot" but copied that text and just dropped the request. I then used the browser back button to get back to the interface and hit Logout (forwarding the requests normally again) and went back to the login page. Now, without being logged in, I just pasted the request for the reboot and forwarded it. It rebooted even though I wasn't logged in.